{{#each flashMessages.queue as |flash|}}
  {{#notification flash=flash}}
    {{flash.message}}
  {{/notification}}
{{/each}}

{{#if busy}}
  <div class="feed-layout__loading">
    <span class="fa-2x">
      <i class="fal fa-spinner fa-spin"></i>
    </span>
  </div>
{{/if}}

{{#unless websocket.isOnline}}
  <div class="feed-layout__warning has-text-danger">
    <i class="fad fa-exclamation-triangle"></i>
  </div>
{{/unless}}

<div class="feed-layout__filters">
  <Layouts::FeedFilters @ordersCounts={{ordersCountsByStatus}} />
</div>

<div class="feed-layout__controls">
  <div class="columns is-marginless is-mobile">
    <div class="column is-2 is-padingless has-text-centered">
      <button class="button is-dark is-outlined" {{action "scrollToTop"}}>
        <span class="icon is-small">
          <i class="far fa-angle-up" aria-hidden="true"></i>
        </span>
        <span>Nahoru</span>
      </button>
    </div>

    <div class="column is-7 is-padingless">
      <SearchBox @searchTerm={{searchTerm}} @onChange={{action (mut searchTerm)}} />
    </div>

    <div class="column is-3 is-padingless has-text-right">
      <div class="feed-layout__on-off-switch">
        <OnOffSwitch @isOn={{kitchenState.isOpen}} @onLabel="Zavřít" @offLabel="Otevřít" @switchAction={{openCloseShop}} />
      </div>
    </div>
  </div>
</div>

<div class="feed-layout__items js-scrollable-feed">

  {{#if showPagination}}
    {{#if lastOrderPaginationPrevToken}}
      <div class="has-text-centered feed-layout__pagination-prev">
        <button class="button is-light is-medium {{if loadMoreOrders.isRunning "is-loading"}}" disabled={{loadMoreOrders.isRunning}} onclick={{perform loadMoreOrders lastOrderPaginationPrevToken "before"}}>Načíst předchozí objednávky</button>
      </div>
    {{/if}}
  {{/if}}

  <div class="feed-layout__scroll-to-here" id="scrollToHere"></div>

  {{#each ordersByTimeSlot as |slot|}}
    <Layouts::FeedTimeSlot @slot={{slot.slot}} @orders={{slot.orders}} />
  {{/each}}

  {{#if showPagination}}
    {{#if lastOrderPaginationNextToken}}
      <div class="has-text-centered feed-layout__pagination-next">
        <button class="button is-light is-medium {{if loadMoreOrders.isRunning "is-loading"}}" disabled={{loadMoreOrders.isRunning}} onclick={{perform loadMoreOrders lastOrderPaginationNextToken "after"}}>Načíst další objednávky</button>
      </div>
    {{/if}}
  {{/if}}

  {{#if noOrdersToShow}}
    <article class="message">
      <div class="message-header">
        <p>Žádné objednávky {{if searchTerm (concat "nenalezeny pro " searchTerm) "v tomhle stavu"}}.</p>
      </div>
      <div class="message-body">
        {{#if searchTerm}}
          Zkus hledat jinak.
        {{else}}
          Přepni filtr nahoře.
        {{/if}}
      </div>
    </article>
  {{/if}}
</div>

<OptionsModal />